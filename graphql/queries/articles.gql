# 全記事を取得します。
query getArticles ($limit: Int = 0, $skip: Int = 0) {
  articlesCollection (order: sys_firstPublishedAt_DESC, limit: $limit, skip: $skip) {
    total
    items {
      ...articleFragment
    }
  }
}

# Idに紐づく記事を取得します。
query getArticleById ($id: String!) {
  articles (id: $id) {
    ...articleFragment
  }
}

# Slugに紐づく記事を取得します。
query getArticleBySlug ($slug: String!) {
  articlesCollection (where: { slug: $slug }, limit: 1) {
    items {
      ...articleFragment
    }
  }
}

# 検索用クエリー
query searchArticles ($value: String!) {
  articlesCollection (where: {
    OR : [
      # タイトル
      { title_contains: $value },
      # 記事内容
      { content_contains: $value },
    ]
  }) {
    items {
      ...articleFragment
    }
  }
}

# 関連記事候補を取得します（タグ or カテゴリ一致）
query getRelatedArticles (
  $currentSlug: String!,
  $tagSlugs: [String!] = [],
  $categorySlug: String = "",
  $limit: Int = 12
) {
  articlesCollection(
    order: sys_firstPublishedAt_DESC,
    limit: $limit,
    where: {
      slug_not: $currentSlug,
      OR: [
        { tags: { slug_in: $tagSlugs } },
        { category: { slug: $categorySlug } }
      ]
    }
  ) {
    items {
      ...articleFragment
    }
  }
}
